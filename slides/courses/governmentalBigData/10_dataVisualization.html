<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Learning Visualization with Dr. Hu</title>
    <meta charset="utf-8" />
    <meta name="author" content="胡悦 清华大学政治学系" />
    <script src="10_dataVisualization_files/header-attrs-2.3/header-attrs.js"></script>
    <link href="10_dataVisualization_files/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
    <link href="10_dataVisualization_files/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
    <link rel="stylesheet" href="css\zh-CN_custom.css" type="text/css" />
    <link rel="stylesheet" href="css\styles.css" type="text/css" />
    <link rel="stylesheet" href="https:\\cdnjs.cloudflare.com\ajax\libs\animate.css\3.7.0\animate.min.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Learning Visualization with Dr. Hu
## 数据可视化理论与实践
### 胡悦<br>清华大学政治学系

---





## 提要

1. 别画什么图
1. 要画什么图
1. 如何引导视线

---

class: small

## 参考书

Cleveland, William S. 1985. *The Elements of Graphing Data*. 1st Printing edition. Monterey, Cal: Wadsworth, Inc.

Tufte, Edward R. 2001. *The Visual Display of Quantitative Information*. 2nd edition edition. Cheshire, Conn: Graphics Press.

Wilkinson, Leland. 2005. *The Grammar of Graphics*. 2nd ed. New York: Springer-Verlag.

张杰. 2019. 《R语言数据可视化之美：专业图表绘制指南》. 第1版. 电子工业出版社.

---

## 心理准备

.center[&lt;img src="images/boring.gif" height = 400 /&gt;]

---

class: small

## “全民可视化”？

Kastellec, Jonathan P., and Eduardo L. Leoni. 2007. “Using Graphs Instead of Tables in Political Science.” *Perspectives on Politics* 5(4): 755–71.

检验APSR，AJPS和PA 2006年五刊，发现如下结果

.center[&lt;img src="images/graphTable.png" height = 300 /&gt;]

--

.magenta[如何可视化上表？]

???
 mathematical: formal modeling

---

background-image: url("images/tableGraph.png")
background-position: center
background-size: contain

---

## 图 vs. 表

.left-column[

### 表

* 容易制作
* 发表常见
* “有助于后续研究”
]

--

.right-column[

### 图

* 制作费事
* 信息不“精确”
* 形式不统一

]

---

class: inverse, bottom

# 可视化鉴赏家
## 培养教程

---

哪个性别及收入水平人群的三酸甘油脂水平趋势与其他均不同？

.center[&lt;img src="images/triglyceride.png" height = 500 /&gt;]

???

身体脂肪量

---

印象更深

便于比较、突出重点

信息传递高效

比表格占据更小版面


---

## 从头开始

.left-column[

&lt;img src="images/tryIt.jpg" height = 300 /&gt;

]

.right-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

---

## 饼状图？

.left-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

.right-column[

&lt;img src="images/pie1.png" height = 300 /&gt;

]

---

## 饼状图？

.left-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

.right-column[

&lt;img src="images/pie2.png" height = 300 /&gt;

]

---

## 饼状图？

.left-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

.right-column[

&lt;img src="images/pie3.png" height = 300 /&gt;

]

---

## 饼状图？

.left-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

.right-column[

&lt;img src="images/pie4.png" height = 300 /&gt;

]

---

## 饼状图？

.left-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

.right-column[

&lt;img src="images/pie5.png" height = 300 /&gt;

]

---

## 饼状图？

.left-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

.right-column[

&lt;img src="images/pie6.png" height = 280 /&gt;

]

---

## Why Is Pie Chart a Big No-No?

* 用于呈现百分比（一维）
* 容易误导读者（见后）
* 浪费油墨（Why do we care?）

被誉为垃圾图形（[junk chart](http://junkcharts.com)）首选

---

## 另一个例子

墨西哥各政党在大选中得票比例趋势

| Party 	| PRI  	| PAN  	| PRD  	| Others 	|
|-------	|------	|------	|------	|--------	|
| 1991  	| 64   	| 17.8 	| 8.2  	| 10     	|
| 1994  	| 60   	| 23.8 	| 14.2 	| 2      	|
| 1997  	| 47.8 	| 24.2 	| 25   	| 3      	|
| 2000  	| 42.2 	| 41.2 	| 10   	| 6.6    	|
| 2003  	| 44.8 	| 30.2 	| 19.4 	| 5.6    	|

怎么可视化这个数据？

---

&lt;img src="images/areaPlot.png" height = 500 /&gt;


---

## No?

.center[&lt;img src="images/areaPlot.png" height = 300 /&gt;]

1. 比折线图费更多墨。

--

1. 各个时间序列间的比较容易误导读者，而且焦点容易被面积所模糊。


???

1. 应将变化较不明显的序列至于最底端。


---

## 高效可视化

.left-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

.right-column[

&lt;img src="images/barPlot1.png" height = 300 /&gt;

]

---

## 高效可视化？

.left-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

.right-column[

&lt;img src="images/barPlot2.png" height = 300 /&gt;

]

---

## 高效可视化

.left-column[

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Day &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Browse &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Monday &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 50 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tuesday &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Wednesday &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Thursday &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Friday &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 90 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Saturday &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 110 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Sunday &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

.right-column[

![](10_dataVisualization_files/figure-html/unnamed-chunk-1-1.png)&lt;!-- --&gt;

]

???

Nightingale Rose diagram, created by the famous Florence Nightingale

Good for time series,save space than bars

---

## 高效可视化

.left-column[

| 政党 	| 得票率 	|
|------	|--------	|
| A    	| 38     	|
| B    	| 34     	|
| C    	| 24     	|
| D    	| 4      	|

]

.right-column[

&lt;img src="images/barPlot3.png" height = 300 /&gt;

]

---

## 一维图升维

.center[&lt;img src="images/radiaPlot.png" height = 400 /&gt;]

---

## 二维数据可视化


| Party 	| PRI  	| PAN  	| PRD  	| Others 	|
|-------	|------	|------	|------	|--------	|
| 1991  	| 64   	| 17.8 	| 8.2  	| 10     	|
| 1994  	| 60   	| 23.8 	| 14.2 	| 2      	|
| 1997  	| 47.8 	| 24.2 	| 25   	| 3      	|
| 2000  	| 42.2 	| 41.2 	| 10   	| 6.6    	|
| 2003  	| 44.8 	| 30.2 	| 19.4 	| 5.6    	|

---

.center[&lt;img src="images/linePlot.png" height = 500 /&gt;]

---

.center[&lt;img src="images/linePlot2.png" height = 500 /&gt;]

---

## 极简主义

.center[&lt;img src="images/scatterPlot.png" height = 400 /&gt;]

---

## 极简主义

.center[&lt;img src="images/scatterPlot2.png" height = 400 /&gt;]

---

## 极简升维

.center[&lt;img src="images/facet.png" height = 400 /&gt;]

---

## 单图多维信息

| 学生 	| 原始成绩 	| 补习班周数 	| 进步分数 	|
|------	|----------	|------------	|----------	|
| A    	| 712      	| 18         	| 100      	|
| B    	| 1105     	| 4          	| 57       	|
| C    	| 690      	| 7          	| 80       	|
| D    	| 687      	| 27         	| 191      	|
| E    	| 725      	| 2          	| 5        	|
| F    	| 1200     	| 25         	| 10       	|
| G    	| 470      	| 19         	| 25       	|
| H    	| 752      	| 10         	| 123      	|


---

## Bubble Chart

.center[&lt;img src="images/bubblePlot.png" height = 400 /&gt;]

--

有什么问题？

---

## Better Bubble Chart

.center[&lt;img src="images/bubblePlot2.png" height = 400 /&gt;]

---

## Bubble Chart 优劣

### Pro

* 散点图变异
* 通过气泡大小呈现第三维度数据

--

### Con

* 气泡大小当接近时可能造成便是困难，信息无法完全精确地传达

---

class: inverse, bottom

# 可视化设计家
## 培养教程

---

## 回归本质：可视化是什么？

.center[&lt;img src="images/socialEngineer.jpg" height = 400 /&gt;]

---

## 可视化的作用

* 记录信息
* 分析推理
* 证实假设
* 交流思想

---

## “工笔”、“写意”之分：统计可视化

.center[&lt;img src="images/sexism_chart.jpg" height = 500 /&gt;]

---

background-image: url("images/sexism_image.jpg")
background-position: center
background-size: contain

## “工笔”、“写意”之分：传播可视化

---

## Attractive vs. Professional

.left-column[&lt;img src="images/africanGDP_image.jpg" height = 300 /&gt;]
.right-column[&lt;img src="images/africanGDP_chart.jpg" height = 400 /&gt;]

---

## 可视化编码

.center[&lt;img src="images/measurement.png" height = 400 /&gt;]

---

## 编码类型



* 数值（continuous）
    + 10厘米，17厘米，23厘米
* 定序（ordinal）
    + 小，中，大
    + 周日，周一，周二……
* 定类（nominal）
    + 苹果，桔子，香蕉……

---

## 编码要素

标记：点、线、面

&lt;img src="images/sign.png" height = 50 /&gt;

--

通道：位置、大小、形状、方向、色调、饱和度、亮度……

&lt;img src="images/pipe.png" height = 100 /&gt;

---

## 通道

.left-column[
&lt;img src="images/category.png" height = 200 /&gt;
&lt;img src="images/group.png" height = 200 /&gt;
]

.right-column[
&lt;img src="images/order.png" height = 400 /&gt;
]

---

class: small

## 通道选择

* 类型（type）
    + 是什么/在哪里（what/where）
    + 何种程度（how much）
    
--
    
* 有效性（effectiveness）
    + 通道表现力符合属性的重要性
    
--

* 表现力（expressiveness）
    + 表达且仅表达数据的完整属性
    + 判断标准（ADSP）：精确性、可辨性、可分离性、视觉突出

???

Accuracy, Discriminibility, Separability, Pop-out

---

### 精确性（Accuracy）

.center[&lt;img src="images/stevensPowerLaw.png" height = 500 /&gt;]

???

刺激增加：

* 关注度敏感度降：点亮度、声音响度
* 关注度敏感度不变：线长度
* 关注度敏感度加：痛感

psychophysicist Stanley Smith Stevens (1957, 1961)

`\(\displaystyle \psi (I)=kI^{a}\)`, k proportionality constant that depends on the units used

---

.left-column[

&lt;img src="images/lattice1.png" height = 400 /&gt;

网格处于背景,会不凸显

]

.right-column[

&lt;img src="images/lattice2.png" height = 400 /&gt;

网格处于前景,遮挡地图

]

---

### 可辨性（Discriminability） 

.center[&lt;img src="images/commuNet.png" height = 500 /&gt;]

???

通过粗细动态表现范围

---

background-image: url("images/contract.png")
background-position: center
background-size: contain


---

### 可分离性（Separability）

.center[&lt;img src="images/separability.png" height = 200 /&gt;]

---

### 视觉突出（Pop-out）

&lt;img src="images/popOut.png" height = 180 /&gt;

--
&lt;img src="images/popOut2.png" height = 300 /&gt;

---

## 焦点引导

.center[&lt;img src="images/picWorthWords.jpg" height = 500 /&gt;]

---

background-image: url("images/popOut3.png")
background-position: center
background-size: contain

---

background-image: url("images/Os.png")
background-position: center
background-size: contain

---

background-image: url("images/Os2.png")
background-position: center
background-size: contain

---

background-image: url("images/Os3.png")
background-position: center
background-size: contain


---

## “看家功夫”：分组与分层

* 分组会对大部分任务有效
* 如果不能进行分组，则需要转换任务目标以支持分组
* 避免过多类别
* 对数据的每个维度指定一种或一个阶层的颜色

---

background-image: url("images/network_democracy.png")
background-position: center
background-size: contain

---

## 色彩信息

* 灰度值可被认为是有序的 

&lt;img src="images/grey1.png" height = 50 /&gt;

* 可用于编码数值型数据

&lt;img src="images/grey2.png" height = 50 /&gt;

* 色调通常认为是无序的，可用于编码不同维度的值

&lt;img src="images/rainbow.png" height = 50 /&gt;

---

## 色彩意义：一种主观感受

.center[&lt;img src="images/colorMeaning.png" height = 300 /&gt;]

---

## 色彩设计基本原则

* 使用有限的色调范围
    + 控制低饱和度色彩中的色彩视觉突出
    + 避免过多颜色交错导致的杂乱无章

--

.left-column[&lt;img src="images/redGreen_w.jpg" height = 300 /&gt;]

--

.right-column[&lt;img src="images/redGreen_r.png" height = 300 /&gt;]

---

* 使用中性背景色
    + 控制对全局色彩的影响
    + 最小化“同时对比” （simultaneous contrast）

--

.left-column[&lt;img src="images/background_apple.jpg" height = 240 /&gt;]

.right-column[&lt;img src="images/background_huawei.jpeg" height = 240 /&gt;]


???

如果纯色为绿色，则灰色色块看起来带有红味,产生颜色偏差

---

## 对于新手而言

辅助软件来选择合适的色阶：

http://colorbrewer2.org/ 

http://paletton.com/


---

class: inverse, bottom

# 理论应用
## 以`ggplot`为例

---

class: small

## `RColorBrewer` Package

### 主要code

`colorRampPalette(brewer.pal(&lt;num.&gt;, &lt;name of pallette&gt;))(n)`

### Alternative

`ggsci`: 包含Nature、Science等期刊配色（Check "Tron Legacy"）

`wesanderson`

`ggthemes`

`ggtech`

---

## Name of Palette

.left-column[&lt;img src="images/color_sequential.png" height = 500 /&gt;]

.right-column[
&lt;img src="images/color_diverging.png" height = 250 /&gt;
&lt;img src="images/color_qualitative.png" height = 200 /&gt;
]

---

## 一维图




```r
ggplot(data = mydata, aes(Cut, Price)) +
  `geom_bar`(
    stat = "identity",
    width = 0.8,
    colour = "black",
    size = 0.25,
    fill = "#2ca25f",
    alpha = 1
  )

ggplot(data = mydata2, aes(Catergory, value, 
                           `fill = variable`)) +
  geom_bar(
    stat = "identity",
    color = "black",
    position = position_dodge(),
    width = 0.7,
    size = 0.25
  ) +
  scale_fill_manual(values = c("#ef8a62", "#67a9cf")) +
  ylim(0, 10) +
  theme(
    axis.title = element_text(size = 15, face = "plain", color = "black"),
    axis.text = element_text(size = 12, face = "plain", color = "black"),
    legend.title = element_text(size = 14, face = "plain", color = "black"),
    legend.background  = element_blank(),
    legend.position = c(0.88, 0.88)
  )
```

---

.left-column[
![](10_dataVisualization_files/figure-html/plot-1DI-1.png)&lt;!-- --&gt;
]

.right-column[
![](10_dataVisualization_files/figure-html/plot-1DII-1.png)&lt;!-- --&gt;
]

---



.left-column[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; car &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; id &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Math &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; English &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Biology &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Music &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R-Coding &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

.right-column[
![](10_dataVisualization_files/figure-html/plot-radar-code-1.png)&lt;!-- --&gt;
]

---


```r
ggplot() + 
  geom_polygon(data=mydata,aes(x=id, y=value),color = "black", fill=brewer.pal(7,"Set1")[1],alpha=0.1)+
  geom_point(data=mydata,aes(x=id, y=value),size=5,shape=21,color = 'black', fill=brewer.pal(7,"Set1")[1])+
  `coord_radar`() +
  scale_x_continuous(breaks =label_data$id,labels=label_data$car)+
  ylim(0,22)+
  theme_light()+
  theme(axis.text.x=element_text(size = 11,colour="black",angle = myAngle))
```

---

class: small

## 二维图



.left-column[

```r
ggplot(data = mydata, aes(x, y)) +
  `geom_point`(
    fill = "black",
    colour = "black",
    size = 3,
    shape = 21
  ) +
  `geom_smooth`(
    method = 'loess',
    span = 0.4,
    se = TRUE,
    colour = "#00A5FF",
    fill = "#00A5FF",
    alpha = 0.2
  ) + 
  scale_y_continuous(breaks = seq(0, 125, 25)) +
  theme(
    text = element_text(size = 15, color = "black"),
    plot.title = element_text(
      size = 15,
      family = "myfont",
      hjust = .5,
      color = "black"
    ),
    legend.position = "none"
  )
```

]

.right-column[
![](10_dataVisualization_files/figure-html/plot-2D-1.png)&lt;!-- --&gt;
]

---

class: small

## 统计图

.left-column[
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#tiqvawtgaz .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tiqvawtgaz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tiqvawtgaz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tiqvawtgaz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tiqvawtgaz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tiqvawtgaz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tiqvawtgaz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tiqvawtgaz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tiqvawtgaz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tiqvawtgaz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tiqvawtgaz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tiqvawtgaz .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#tiqvawtgaz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tiqvawtgaz .gt_from_md > :first-child {
  margin-top: 0;
}

#tiqvawtgaz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tiqvawtgaz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tiqvawtgaz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#tiqvawtgaz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tiqvawtgaz .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#tiqvawtgaz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tiqvawtgaz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tiqvawtgaz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tiqvawtgaz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tiqvawtgaz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tiqvawtgaz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#tiqvawtgaz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tiqvawtgaz .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#tiqvawtgaz .gt_left {
  text-align: left;
}

#tiqvawtgaz .gt_center {
  text-align: center;
}

#tiqvawtgaz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tiqvawtgaz .gt_font_normal {
  font-weight: normal;
}

#tiqvawtgaz .gt_font_bold {
  font-weight: bold;
}

#tiqvawtgaz .gt_font_italic {
  font-style: italic;
}

#tiqvawtgaz .gt_super {
  font-size: 65%;
}

#tiqvawtgaz .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="tiqvawtgaz" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Model 1</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">(Intercept)</td>
      <td class="gt_row gt_left">41.108***</td>
    </tr>
    <tr>
      <td class="gt_row gt_left"></td>
      <td class="gt_row gt_left">(2.842)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">cyl</td>
      <td class="gt_row gt_left">-1.785***</td>
    </tr>
    <tr>
      <td class="gt_row gt_left"></td>
      <td class="gt_row gt_left">(0.607)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">disp</td>
      <td class="gt_row gt_left">0.007</td>
    </tr>
    <tr>
      <td class="gt_row gt_left"></td>
      <td class="gt_row gt_left">(0.012)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">wt</td>
      <td class="gt_row gt_left">-3.636***</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
      <td class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">(1.040)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Num.Obs.</td>
      <td class="gt_row gt_left">32</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">R2</td>
      <td class="gt_row gt_left">0.833</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">R2 Adj.</td>
      <td class="gt_row gt_left">0.815</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">AIC</td>
      <td class="gt_row gt_left">157.6</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">BIC</td>
      <td class="gt_row gt_left">164.9</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Log.Lik.</td>
      <td class="gt_row gt_left">-73.779</td>
    </tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="2">* p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01</td>
    </tr>
  </tfoot>
  
</table></div>
]

.right-column[

```r
library(dotwhisker)
dwplot(m1)
```

![](10_dataVisualization_files/figure-html/ols-dw-1.png)&lt;!-- --&gt;
]

---

class: small

## 网络图 (Complete Network)


```r
library(network) # for data
data(emon)
`library(ggnetwork)`

ggplot(emon[[1]], aes(
  x = x,
  y = y,
  xend = xend,
  yend = yend
)) +
  `geom_edges`(arrow = arrow(length = unit(6, "pt"), type = "closed")) +
  `geom_nodes`(color = "tomato", size = 4)
```

---

&lt;img src="10_dataVisualization_files/figure-html/network-plot-1.png" style="display: block; margin: auto;" /&gt;

---

## 网络图 (Sankey/Alluvial)


```r
`library(ggalluvial)`
data(vaccinations)
levels(vaccinations$response) &lt;- rev(levels(vaccinations$response))

ggplot(vaccinations,
       aes(x = survey, stratum = response, alluvium = subject,
           y = freq,
           fill = response, label = response)) +
  scale_x_discrete(expand = c(.1, .1)) +
  `geom_flow()` +
  `geom_stratum(alpha = .5)` +
  geom_text(stat = "stratum", size = 3) +
  theme(legend.position = "none") +
  ggtitle("vaccination survey responses at three points in time")
```

---

&lt;img src="10_dataVisualization_files/figure-html/sankey-plot-1.png" style="display: block; margin: auto;" /&gt;

---

## 地图

你需要三个ArcGIS文件：

`bou2_4p.shp`: 多边形要素图形文件

`bou2_4p.dbf`: 要素属性信息

`bou2_4p.shx`: 多边形要素索引文件


---


```r
china_map1 &lt;- rgdal::readOGR("data/bou2_4p.shp")

ggplot(china_map1, aes(x = long, y = lat, group = group)) +
	geom_polygon(fill = 'beige') + 
  geom_path(color = "grey40")
```

&lt;img src="10_dataVisualization_files/figure-html/map-1.png" style="display: block; margin: auto;" /&gt;


---

background-image: url("images/patrioBase9709.gif")
background-position: center
background-size: contain

## gganimate

---

name: takeHome

## Take-Home Points

* 好的图形必须进行.magenta[比较]分析。
* 图形不仅可以呈现原始数据，也可以呈现.magenta[推论]结果。
* .magenta[善用]数据可视化，方能成为沟通研究者与读者的工具。

---

background-image: url("images/powerWisely.jpg")
background-position: center
background-size: contain

---

class: inverse, center, middle

# Thank you!

&lt;i class="fa fa-envelope fa-lg"&gt;&lt;/i&gt;&amp;nbsp; [yuehu@tsinghua.edu.cn](mailto:yuehu@tsinghua.edu.cn)

&lt;i class="fa fa-globe fa-lg"&gt;&lt;/i&gt;&amp;nbsp; https://sammo3182.github.io/

&lt;i class="fab fa-github fa-lg"&gt;&lt;/i&gt;&amp;nbsp; [sammo3182](https://github.com/sammo3182)


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js?config=TeX-MML-AM_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
